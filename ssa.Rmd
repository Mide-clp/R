---
title: "Social security disablity data"
author: "ccllpp"
date: "12/8/2021"
output: html_document

#### Loading library

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
```

#### Importing the social security disability claim application data set

```{r}
ssa <- read_csv("http://594442.youcanlearnit.net/ssadisability.csv")
glimpse(ssa)
```

#### converting data from wide to long

```{r}
ssa_long <- gather(ssa, month, Application, -Fiscal_Year)
glimpse(ssa_long)
```

#### putting dates in a  format for use

```{r}
ssa_long$Fiscal_Year <- str_replace(ssa_long$Fiscal_Year, "FY", "20")
ssa_long <- separate(ssa_long, month, c("month", "application_method"), sep = "_")
unique(ssa_long$month)
join_date <- dmy(paste("1", ssa_long$month, ssa_long$Fiscal_Year))
ssa_long <- ssa_long %>% 
  mutate(date = join_date)
print(ssa_long)
```

#### drop fiscal_year and month

```{r}
ssa_long$Fiscal_Year <- NULL
ssa_long$month <- NULL
```

#### saving application method as factor

```{r}
ssa_long$application_method <- as.factor(ssa_long$application_method)
unique(ssa_long$application_method)
```

#### Government use fsicar year
##### changing date from fiscal year to actual year

```{r}
ddd <- which(month(ssa_long$date) >=10)
year(ssa_long$date) <- year(ssa_long$date[ddd]) - 1
ssa_long
```

#### converting data from wide to long

```{r}
ssa_wide <- spread(ssa_long, application_method, Application)
```

#### percentage of internet collection

```{r}
ssa_wide$percentage_online <-  (ssa_wide$Internet/ssa_wide$Total) * 100
print(ssa_wide, n=20)
```

### time serries of growth on internet 

```{r}
ggplot(data = ssa_wide)+
  geom_point(mapping = aes(x = date, y = percentage_online, color = "orange"))
```


